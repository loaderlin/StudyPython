


## 计算机网络概述

国际化组织发布的OSI/RM 七层模型

TCP/IP是一个四层模型


IP通常被翻译为网际协议，它服务于网络层，主要实现了寻址和路由的功能。

TCP全称传输控制协议，它是基于IP提供的寻址和路由服务而建立起来的负责实现端到端可靠传输的协议，
之所以将TCP称为可靠的传输协议是因为TCP向调用者承诺了三件事情


- 数据不传丢不传错（利用握手、校验和重传机制可以实现）。
- 流量控制（通过滑动窗口匹配数据发送者和接收者之间的传输速度）。
- 拥塞控制（通过RTT时间以及对滑动窗口的控制缓解网络拥堵）。

JSON(JavaScript Object Notation) 是一种轻量级的数据交换语言，尽管JSON是最初只是Javascript中一种创建对象的字面量语法，但它在当下更是一种独立于语言的数据格式。

### 基于传输层协议的套接字编程

套接字是一套用C语言编写的应用程序开发库，主要用于实现进程间通讯和网络编程。

#### TCP套接字

TCP套接字就是使用TCP协议提供的传输服务来实现网络通信的编程接口。

实现一个提供时间日期的服务器

1. socket_server.py 部署到A服务器上
2. socket_client.py 部署到B服务器上
3. 先启动A服务，后启动B服务


开启服务端步骤

1. 创建套接字对象并指定使用那种传输服务
2. 绑定IP地址和端口(端口用于区分不同的服务)
3. 开启监听 - 监听客户端连接到服务器
4. 通过循环接收客户端的连接并作出相应的处理
5. 发送数据
6. 断开连接

- family=AF_INET - IPv4地址
- family=AF_INET6 - IPv6地址
- type=SOCK_STREAM - TCP套接字
- type=SOCK_DGRAM - UDP套接字
- type=SOCK_RAW - 原始套接字

客户端配置

1. 创建套接字对象默认使用IPv4和TCP协议
2. 连接到服务器(需要指定IP地址和端口)
3. 从服务器接收数据

> JSON 是纯文本不能携带二进制数据 所以图片的二进制数据要处理成base64编码

```py
from base64 import b64encode
with open('data.jpg', 'rb') as f:
    data = b64encode(f.read()).decode('utf-8')

f.read() > b64encode > decode > dumps > encode 

data > in_data(client.recv) > decode > loads > encode > b64decode > write()
```

#### UDP套接字

传输层除了有可靠的传输协议TCP之外，还有一种非常轻便的传输协议叫做用户数据报协议，简称UDP。

TCP和UDP都是提供端到端传输服务的协议，二者的差别就如同打电话和发短信的区别，后者不对传输的可靠性和可达性做出任何承诺从而避免了TCP中握手和重传的开销，所以在强调性能和而不是数据完整性的场景中(例如传输网络音频数据)，UDP可能是更好的选择。

可能大家会注意到一个现象，就是在观看网络视频时，有时会出现卡顿，有时会出现花屏，这无非就是部分数据传丢或传错造成的。